{"version":3,"kind":"Notebook","sha256":"75a6f7ff6c48eabbc3108e067709162fd9755139efc399bcda67113445054740","slug":"linear-regression-advanced-model","location":"/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","dependencies":[],"frontmatter":{"title":"Linear regression - Advanced model","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"science","language":"python"},"github":"https://github.com/symmeHub/positron","numbering":{"title":{"offset":2}},"source_url":"https://github.com/symmeHub/positron/blob/main/book/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","edit_url":"https://github.com/symmeHub/positron/edit/main/book/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","exports":[{"format":"ipynb","filename":"02_Linear_regression_Advanced_Model.ipynb","url":"/armageddon/build/02_Linear_regression-98e8dffbd390dc060ce2eba2486453d8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VMlCVXj8uO"}],"key":"QNieHha6aq"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"this notebook folows the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KHugCbMIcF"},{"type":"link","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"linear regression basics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jdyoJNZT45"}],"identifier":"datam:support:linreg","label":"dataM:support:LinReg","url":"/linear-regression-linear-model","internal":true,"dataUrl":"/linear-regression-linear-model.json","key":"Uukc6KQlMP"},{"type":"text","value":" notebook.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WjzvyZXgGv"}],"key":"WI6QjRXyTI"}],"class":"tip ","key":"sHrwbv4toe"}],"key":"bGUG9mkQ6C"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scope","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MFrhUu4q7c"}],"identifier":"scope","label":"Scope","html_id":"scope","implicit":true,"key":"lKAURzXa1q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A finite number ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dW4L574E7y"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"rZyKlu1ALS"},{"type":"text","value":" of data points are available: find the best fit of a given parametrique function going trouth this ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xCnhgZFiGH"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"I42yjZEdiX"},{"type":"text","value":" points.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UfqLiRMAf8"}],"key":"DWJMDadmD7"}],"key":"ApomvCxVjD"}],"key":"EaqgoUHejx"}],"key":"PHDFj1rZAg"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# setup\n%load_ext autoreload\n%matplotlib ipympl\n%autoreload 2\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl","visibility":"hide","key":"rVHBG7cVLE"},{"type":"outputs","id":"WkvsUDaH9vFmfCNn8_cJY","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"Matplotlib is building the font cache; this may take a moment.\n"},"key":"V8t5KahvZR"}],"visibility":"show","key":"sFP3WwkLON"}],"visibility":"show","key":"UtcuVY1W8q"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The data set : a synthetique data set with some noise","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A9JU5gx89T"}],"identifier":"the-data-set-a-synthetique-data-set-with-some-noise","label":"The data set : a synthetique data set with some noise","html_id":"the-data-set-a-synthetique-data-set-with-some-noise","implicit":true,"key":"gxqDCqpu7Z"}],"key":"VsS8zlg4Qx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"Nb_data_point = 200  # number of points\nxmin, xmax = -0.5, 5.5  # x range\n\nx = np.linspace(xmin, xmax, Nb_data_point)\nx = x + 0.2 * np.random.rand(Nb_data_point)  # add noise\n\ny = x**4 - 12 * x**3 + 47 * x**2 - 60 * x\ny = y + 1 * np.random.randn(Nb_data_point)  # add noise","visibility":"show","key":"e9dPtrQIcu"},{"type":"outputs","id":"XrcuJoYoTlQ44UBMbfbmi","children":[],"visibility":"show","key":"Nph5fqiQH6"}],"visibility":"show","key":"u1Uj4nAOTd"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \".\", label=\"Data\")\nplt.legend()\nplt.grid()","visibility":"show","key":"INfM9j6r6n"},{"type":"outputs","id":"33y0XUhdJs96Waobqt9vu","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e2b8a3d1c36ab0c593426e421be9bcd2","path":"/armageddon/build/e2b8a3d1c36ab0c593426e421be9bcd2.png"},"text/html":{"content_type":"text/html","hash":"d545cfa8746bcf85531c95ed62c4e7d9","path":"/armageddon/build/d545cfa8746bcf85531c95ed62c4e7d9.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"735fd3a473164215a9f851112a831467\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"nfSdbwey9n"}],"visibility":"show","key":"nidOeEXqSa"}],"visibility":"show","key":"oauwQXAKlv"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We would like to fit this data with a linear piecewise function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ba49JofUlZ"}],"identifier":"we-would-like-to-fit-this-data-with-a-linear-piecewise-function","label":"We would like to fit this data with a linear piecewise function","html_id":"we-would-like-to-fit-this-data-with-a-linear-piecewise-function","implicit":true,"key":"MMKBNShhqq"}],"key":"IPpnoVhpGL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To do so we need first a base, let’s use linear piecewise function function use in the FE methode","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cIgTaPzbs7"}],"key":"sSdfAwNOgL"}],"key":"XLm3pxuKPD"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def hat(x, xc, support=1):\n    \"\"\"\n    Compute the hat function, which is a piecewise linear function that peaks at `xc` and\n    decreases linearly to zero within the given `support`.\n\n    Parameters:\n    x (array-like): Input array of values.\n    xc (float): Center of the peak.\n    support (float, optional): Width of the support region. Default is 1.\n\n    Returns:\n    numpy.ndarray: Array of the same shape as `x`, containing the computed hat function values.\n    \"\"\"\n\n    y = np.maximum(1 - np.abs((x - xc) / support), 0.0)\n    return y","visibility":"show","key":"yrCpZH7qTh"},{"type":"outputs","id":"12Pijakic618zi7m9ij9N","children":[],"visibility":"show","key":"z4q0vlWUMg"}],"visibility":"show","key":"gZk1SOzN4J"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bases function settings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tNxIfQti17"}],"identifier":"bases-function-settings","label":"Bases function settings","html_id":"bases-function-settings","implicit":true,"key":"AR5k7k29VE"}],"key":"Q6DV8CDBy5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"Nf = 9  # number of bases function\n\nxc_list = np.linspace(xmin, xmax, Nf)\nxc_list.shape\nsupport = (xmax - xmin) / (Nf - 1)","visibility":"show","key":"eo5ryQQ5TX"},{"type":"outputs","id":"zD4Jibcm5q8e5agvtFnqw","children":[],"visibility":"show","key":"FItK35l8vU"}],"visibility":"show","key":"TtegM5F9s2"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the hat functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ItkB2ZKObh"}],"identifier":"draw-the-hat-functions","label":"Draw the hat functions","html_id":"draw-the-hat-functions","implicit":true,"key":"bKXHtmWdr9"}],"key":"geVEa5v0Nb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 1000\nx_hat = np.linspace(xmin, xmax, N)","visibility":"show","key":"nX460F8SdI"},{"type":"outputs","id":"U8vVq0mZyMLTXxNLSS1Zq","children":[],"visibility":"show","key":"jfw2CT5Lr2"}],"visibility":"show","key":"UadhyupYCZ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfor i in range(0, len(xc_list)):\n    plt.plot(x_hat, hat(x_hat, xc_list[i], support))\nplt.grid()","visibility":"show","key":"ssqFOVsOHP"},{"type":"outputs","id":"2R3EA1wqpPMLuTNTLbRiI","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b00492974b2af6918eec10da62b2aaef","path":"/armageddon/build/b00492974b2af6918eec10da62b2aaef.png"},"text/html":{"content_type":"text/html","hash":"cd594615e85d443dca6c0457ffc1b0a3","path":"/armageddon/build/cd594615e85d443dca6c0457ffc1b0a3.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"fa9f49c9476d40e8a2dab697e00a08a0\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"iMnRtXcuV2"}],"visibility":"show","key":"ARR429AKFZ"}],"visibility":"show","key":"ZKnW6xFTg5"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fit the data using this base of functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oj4UoVYaHl"}],"identifier":"fit-the-data-using-this-base-of-functions","label":"Fit the data using this base of functions","html_id":"fit-the-data-using-this-base-of-functions","implicit":true,"key":"h4812u0VE8"}],"key":"t987tf6Ik1"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determination of the coefficent by regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4pVL9qsBC"}],"identifier":"determination-of-the-coefficent-by-regression","label":"Determination of the coefficent by regression","html_id":"determination-of-the-coefficent-by-regression","implicit":true,"key":"ycz5OGFQoA"}],"key":"UWospnsYZ7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Construcion of the X matrix\nX = np.zeros((Nf, len(x)))\nfor i in range(0, len(xc_list)):\n    X[i, :] = hat(x, xc_list[i], support)\n    # X = np.append(X, [hat(x, xc_list[i], support)], axis=0)\nX = X.T\n\n# Construcion of the Y matrix\nY = y.T\n\n# Computation of the least square estimator\nbeta = np.dot(np.linalg.inv(np.dot(X.T, X)), np.dot(X.T, Y))\n\nprint(\"The fitted coeff:\")\nprint(beta)","visibility":"show","key":"SzGDDxrOik"},{"type":"outputs","id":"GNd_jas7I1VeaWBF7RCXp","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"The fitted coeff:\n[ 37.02385787 -16.274607   -25.90194326 -16.51738924  -3.97754072\n   1.48193844   0.49586078  -3.29562981   9.43414501]\n"},"key":"hMTg6n9l28"}],"visibility":"show","key":"mSawHnPYBy"}],"visibility":"show","key":"ODZWBzlsSS"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R2nPEmJJGz"}],"identifier":"draw-the-results","label":"Draw the results","html_id":"draw-the-results","implicit":true,"key":"KLdqebbivA"}],"key":"zA59WHlFu1"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 100\nxi = np.linspace(xmin, xmax, N)\n\nyi = np.zeros(xi.shape)\nfor i in range(0, len(xc_list)):\n    yi = yi + beta[i] * hat(xi, xc_list[i], support)","visibility":"show","key":"uzdx6zeU5b"},{"type":"outputs","id":"pLuAji4IovLwzz_qv7Hqj","children":[],"visibility":"show","key":"oJOGaUNWJI"}],"visibility":"show","key":"EwMA0Y9Hvb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \"o\", label=\"Data\")\nplt.plot(xi, yi, \"r\", label=\"Regression\")\nplt.legend()\nplt.grid()","visibility":"show","key":"k53IJh4cTm"},{"type":"outputs","id":"ZJLYkZXovZMwDQraG4Kwt","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"620d894e7f196fbf2ae1f46a5ffb7f87","path":"/armageddon/build/620d894e7f196fbf2ae1f46a5ffb7f87.png"},"text/html":{"content_type":"text/html","hash":"dd74f9032e70a50c3146cd0ec7370a3d","path":"/armageddon/build/dd74f9032e70a50c3146cd0ec7370a3d.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"9a226cf1f58b48c5a9a5f39fd102cd99\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"B67VZr2zfB"}],"visibility":"show","key":"EJJnuhPV4d"}],"visibility":"show","key":"feqbXTFzIp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Work with other bases","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yuDCOQqmVW"}],"identifier":"work-with-other-bases","label":"Work with other bases","html_id":"work-with-other-bases","implicit":true,"key":"o4hkFkWVQx"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Radial basis function (RBF) is a good candidate to fit the data.\nIt will creat a smooth curve that will fit the data, but due to the non finite support of the RBF function, the matrix to invert will be ill conditionned.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zY4GaFAfZI"}],"key":"IXDw1kt1wq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The gaussian RBF is defined as follow:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"psT74nMXIm"}],"key":"iV8DO5S5IX"},{"type":"math","value":"\\phi(x) = \\exp\\left(-\\left(\\frac{x-x_c}{lc}\\right)^2\\right)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>c</mi></msub></mrow><mrow><mi>l</mi><mi>c</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mn>2</mn></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\phi(x) = \\exp\\left(-\\left(\\frac{x-x_c}{lc}\\right)^2\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.654em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"1","key":"XU1mjnY41g"}],"key":"KxDJGZOnsK"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def hat(x, xc, support=1):\n    ### RBF\n    y = np.exp(-((np.abs(x - xc) / support) ** 2))\n    return y","visibility":"show","key":"vxJ4S4smZk"},{"type":"outputs","id":"LdHJqWE2cBy9N_nIl7gcx","children":[],"visibility":"show","key":"uaOptxwdoM"}],"visibility":"show","key":"k1ng5lDRSc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfor i in range(0, len(xc_list)):\n    plt.plot(x_hat, hat(x_hat, xc_list[i], support))\nplt.grid()","key":"WKJB40kt8z"},{"type":"outputs","id":"9hqHZD4jEfYz4k1d6pqi7","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"23b9096177911d3e50b6ea0ab5cf3dc3","path":"/armageddon/build/23b9096177911d3e50b6ea0ab5cf3dc3.png"},"text/html":{"content_type":"text/html","hash":"e7cafc7f655fbd2e97f71aba2da29a40","path":"/armageddon/build/e7cafc7f655fbd2e97f71aba2da29a40.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"7291b8d0792040f5b36b2f97558cf63f\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"BE82gcFiaD"}],"key":"Ev2gLOh5or"}],"key":"vsdive6YUB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fit the data using this base of functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zTWR1dgmyQ"}],"identifier":"fit-the-data-using-this-base-of-functions","label":"Fit the data using this base of functions","html_id":"fit-the-data-using-this-base-of-functions-1","implicit":true,"key":"RMI4Xls3WR"}],"key":"LYBoEX8Kgo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Construcion of the X matrix\nX = np.zeros((Nf, len(x)))\nfor i in range(0, len(xc_list)):\n    X[i, :] = hat(x, xc_list[i], support)\nX = X.T\n\n# Construcion of the Y matrix\nY = y.T\n\n# Computation of the least square estimator\nbeta = np.dot(np.linalg.inv(np.dot(X.T, X)), np.dot(X.T, Y))\n\nprint(\"The fitted coeff:\")\nprint(beta)","key":"s4IpNIz7ZE"},{"type":"outputs","id":"QCGTVsUIvoGIl-yZfxarA","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"The fitted coeff:\n[ 40.3808368  -24.28863137 -10.00502152 -13.56302099   1.67378011\n  -1.39221328   3.96758795  -7.79903348  11.16852575]\n"},"key":"QxxMC4Ueqh"}],"key":"c3rBVJKzl1"}],"key":"THRfVoESbL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jnsGItIkXv"}],"identifier":"draw-the-results","label":"Draw the results","html_id":"draw-the-results-1","implicit":true,"key":"iqf06T82QV"}],"key":"lH4YOzBKYZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = 100\nxi = np.linspace(xmin, xmax, N)\n\nyi = np.zeros(xi.shape)\nfor i in range(0, len(xc_list)):\n    yi = yi + beta[i] * hat(xi, xc_list[i], support)","key":"Jf0DoTnc8G"},{"type":"outputs","id":"_Bkw5bHkCceWBmkh2Ku29","children":[],"key":"Zmf2mdpdfA"}],"key":"kH6PqLBDXr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \"o\", label=\"Data\")\nplt.plot(xi, yi, \"r\", label=\"Regression\")\nplt.legend()\nplt.grid()","key":"c7vLxvdWV9"},{"type":"outputs","id":"YeGlEhrFIcW40HnZwN0fA","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2b35e635ddcd2da89ba3115095a1d9ec","path":"/armageddon/build/2b35e635ddcd2da89ba3115095a1d9ec.png"},"text/html":{"content_type":"text/html","hash":"bdb846dbb75e8853ec1cc43915851889","path":"/armageddon/build/bdb846dbb75e8853ec1cc43915851889.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"6431ffab61a64c6684eb6d3e708dacb4\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"vUD9jI5Ebs"}],"key":"UdvTHrM1jT"}],"key":"jDcnX1jzdA"}],"key":"TsU30kYhV0"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Linear regression - Linear model","url":"/linear-regression-linear-model","group":"Data"},"next":{"title":"Derivation of numerical data","url":"/numerical-derivation","group":"Data"}}},"domain":"http://localhost:3004"}