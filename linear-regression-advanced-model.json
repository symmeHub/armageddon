{"version":3,"kind":"Notebook","sha256":"75a6f7ff6c48eabbc3108e067709162fd9755139efc399bcda67113445054740","slug":"linear-regression-advanced-model","location":"/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","dependencies":[],"frontmatter":{"title":"Linear regression - Advanced model","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"science","language":"python"},"github":"https://github.com/symmeHub/positron","numbering":{"title":{"offset":2}},"source_url":"https://github.com/symmeHub/positron/blob/main/book/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","edit_url":"https://github.com/symmeHub/positron/edit/main/book/data_analysis/support_material/02_Linear_regression_Advanced_Model.ipynb","exports":[{"format":"ipynb","filename":"02_Linear_regression_Advanced_Model.ipynb","url":"/armageddon/build/02_Linear_regression-98e8dffbd390dc060ce2eba2486453d8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BOkbq7kAnW"}],"key":"PU42vWLFjS"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"this notebook folows the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Yk0S9t9U6q"},{"type":"link","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"linear regression basics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ydq3zXulzA"}],"identifier":"datam:support:linreg","label":"dataM:support:LinReg","url":"/linear-regression-linear-model","internal":true,"dataUrl":"/linear-regression-linear-model.json","key":"Z8uL4Grl5N"},{"type":"text","value":" notebook.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Yi3HQxuxMF"}],"key":"nymRgGesfP"}],"class":"tip ","key":"PR6H6w0N1i"}],"key":"TzyrZlKoCM"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scope","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fMscUVLEnB"}],"identifier":"scope","label":"Scope","html_id":"scope","implicit":true,"key":"A9LwnZbsUg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A finite number ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IdHcfnBdK6"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"aSXMqWZh5L"},{"type":"text","value":" of data points are available: find the best fit of a given parametrique function going trouth this ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kNAUsKuQl2"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"gdTcQ1Z3dL"},{"type":"text","value":" points.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ioNXPTdANY"}],"key":"uaRworiYQo"}],"key":"x7OKzl47O8"}],"key":"JgaHSIYW7B"}],"key":"kxqi20seAw"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# setup\n%load_ext autoreload\n%matplotlib ipympl\n%autoreload 2\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl","visibility":"hide","key":"xQUbouQvZd"},{"type":"outputs","id":"0JqfSaoJBKSuQOdwYyT2f","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"Matplotlib is building the font cache; this may take a moment.\n"},"key":"u799l2YIGm"}],"visibility":"show","key":"SkpYbMEBQl"}],"visibility":"show","key":"NlShrk75q5"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The data set : a synthetique data set with some noise","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Stj7GuaCQy"}],"identifier":"the-data-set-a-synthetique-data-set-with-some-noise","label":"The data set : a synthetique data set with some noise","html_id":"the-data-set-a-synthetique-data-set-with-some-noise","implicit":true,"key":"hcJYT43iNM"}],"key":"HUn5AXzr8k"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"Nb_data_point = 200  # number of points\nxmin, xmax = -0.5, 5.5  # x range\n\nx = np.linspace(xmin, xmax, Nb_data_point)\nx = x + 0.2 * np.random.rand(Nb_data_point)  # add noise\n\ny = x**4 - 12 * x**3 + 47 * x**2 - 60 * x\ny = y + 1 * np.random.randn(Nb_data_point)  # add noise","visibility":"show","key":"JhHtwcdrf5"},{"type":"outputs","id":"Qw4M7-QbLjDooVYNkRq0k","children":[],"visibility":"show","key":"qoKJKLoJzS"}],"visibility":"show","key":"PMeuXUI1ZB"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \".\", label=\"Data\")\nplt.legend()\nplt.grid()","visibility":"show","key":"p13oAmKnJz"},{"type":"outputs","id":"k2xoU8UtlHAXhESbiwCAT","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e2b8a3d1c36ab0c593426e421be9bcd2","path":"/armageddon/build/e2b8a3d1c36ab0c593426e421be9bcd2.png"},"text/html":{"content_type":"text/html","hash":"d545cfa8746bcf85531c95ed62c4e7d9","path":"/armageddon/build/d545cfa8746bcf85531c95ed62c4e7d9.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"735fd3a473164215a9f851112a831467\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"dEPXpK81pN"}],"visibility":"show","key":"fZ0P7X498R"}],"visibility":"show","key":"q0HCew6mVE"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We would like to fit this data with a linear piecewise function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jRQWUTXzKw"}],"identifier":"we-would-like-to-fit-this-data-with-a-linear-piecewise-function","label":"We would like to fit this data with a linear piecewise function","html_id":"we-would-like-to-fit-this-data-with-a-linear-piecewise-function","implicit":true,"key":"ROBvrtmdAD"}],"key":"aG0tfw1Y8s"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To do so we need first a base, let’s use linear piecewise function function use in the FE methode","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l5kbj3bBoH"}],"key":"voYsCDaibr"}],"key":"atwK7OxanL"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def hat(x, xc, support=1):\n    \"\"\"\n    Compute the hat function, which is a piecewise linear function that peaks at `xc` and\n    decreases linearly to zero within the given `support`.\n\n    Parameters:\n    x (array-like): Input array of values.\n    xc (float): Center of the peak.\n    support (float, optional): Width of the support region. Default is 1.\n\n    Returns:\n    numpy.ndarray: Array of the same shape as `x`, containing the computed hat function values.\n    \"\"\"\n\n    y = np.maximum(1 - np.abs((x - xc) / support), 0.0)\n    return y","visibility":"show","key":"OonAICiwKI"},{"type":"outputs","id":"JsMSJTPgqpnZztjnVOChx","children":[],"visibility":"show","key":"SlCSnVRlwd"}],"visibility":"show","key":"de5Dfhxkyl"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bases function settings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LW3qEpk0Uv"}],"identifier":"bases-function-settings","label":"Bases function settings","html_id":"bases-function-settings","implicit":true,"key":"RD6e2On3h1"}],"key":"zsbURIuyZ4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"Nf = 9  # number of bases function\n\nxc_list = np.linspace(xmin, xmax, Nf)\nxc_list.shape\nsupport = (xmax - xmin) / (Nf - 1)","visibility":"show","key":"clyvZAXisl"},{"type":"outputs","id":"7In361W68DlP1L5IvRi5G","children":[],"visibility":"show","key":"jzENbY1hlL"}],"visibility":"show","key":"fR4sTf0InE"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the hat functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eb9Y1rBiGc"}],"identifier":"draw-the-hat-functions","label":"Draw the hat functions","html_id":"draw-the-hat-functions","implicit":true,"key":"euLU0ujyaS"}],"key":"XmaLRafuAh"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 1000\nx_hat = np.linspace(xmin, xmax, N)","visibility":"show","key":"qYwkp4qGS8"},{"type":"outputs","id":"lL_MqJvZrRmtsO8TfuaT-","children":[],"visibility":"show","key":"An5G84qba3"}],"visibility":"show","key":"Md5NcrU2MQ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfor i in range(0, len(xc_list)):\n    plt.plot(x_hat, hat(x_hat, xc_list[i], support))\nplt.grid()","visibility":"show","key":"UJhrVzUB3v"},{"type":"outputs","id":"sYZJFkHOOSGjEkTr1MB7T","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b00492974b2af6918eec10da62b2aaef","path":"/armageddon/build/b00492974b2af6918eec10da62b2aaef.png"},"text/html":{"content_type":"text/html","hash":"cd594615e85d443dca6c0457ffc1b0a3","path":"/armageddon/build/cd594615e85d443dca6c0457ffc1b0a3.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"fa9f49c9476d40e8a2dab697e00a08a0\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"x90Ux8v3CX"}],"visibility":"show","key":"C3qfigziRD"}],"visibility":"show","key":"Si9HTATEKY"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fit the data using this base of functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R3TsufLyGp"}],"identifier":"fit-the-data-using-this-base-of-functions","label":"Fit the data using this base of functions","html_id":"fit-the-data-using-this-base-of-functions","implicit":true,"key":"xgJyi1iZ4Y"}],"key":"drzzVFrve9"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determination of the coefficent by regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jaWFFKobzT"}],"identifier":"determination-of-the-coefficent-by-regression","label":"Determination of the coefficent by regression","html_id":"determination-of-the-coefficent-by-regression","implicit":true,"key":"skTGo9S9AT"}],"key":"e7fAnl6JfO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Construcion of the X matrix\nX = np.zeros((Nf, len(x)))\nfor i in range(0, len(xc_list)):\n    X[i, :] = hat(x, xc_list[i], support)\n    # X = np.append(X, [hat(x, xc_list[i], support)], axis=0)\nX = X.T\n\n# Construcion of the Y matrix\nY = y.T\n\n# Computation of the least square estimator\nbeta = np.dot(np.linalg.inv(np.dot(X.T, X)), np.dot(X.T, Y))\n\nprint(\"The fitted coeff:\")\nprint(beta)","visibility":"show","key":"UHDg69beo9"},{"type":"outputs","id":"KAJoJ__sbCpXeZtk0RWeS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"The fitted coeff:\n[ 37.02385787 -16.274607   -25.90194326 -16.51738924  -3.97754072\n   1.48193844   0.49586078  -3.29562981   9.43414501]\n"},"key":"lPfq4bgAxV"}],"visibility":"show","key":"uq0OU6HYFM"}],"visibility":"show","key":"bhg5VLZ2II"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NXHi8k6WLG"}],"identifier":"draw-the-results","label":"Draw the results","html_id":"draw-the-results","implicit":true,"key":"AkO3dDrDDg"}],"key":"orj0Dgd1B0"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 100\nxi = np.linspace(xmin, xmax, N)\n\nyi = np.zeros(xi.shape)\nfor i in range(0, len(xc_list)):\n    yi = yi + beta[i] * hat(xi, xc_list[i], support)","visibility":"show","key":"Qkctz40qR2"},{"type":"outputs","id":"z8cdCJRwwdKdkR9ageTav","children":[],"visibility":"show","key":"fxAVrAAJML"}],"visibility":"show","key":"qS1qPfdwsi"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \"o\", label=\"Data\")\nplt.plot(xi, yi, \"r\", label=\"Regression\")\nplt.legend()\nplt.grid()","visibility":"show","key":"cdEKlP5Da0"},{"type":"outputs","id":"SvTKhluQyFazItQ82k_iU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"620d894e7f196fbf2ae1f46a5ffb7f87","path":"/armageddon/build/620d894e7f196fbf2ae1f46a5ffb7f87.png"},"text/html":{"content_type":"text/html","hash":"dd74f9032e70a50c3146cd0ec7370a3d","path":"/armageddon/build/dd74f9032e70a50c3146cd0ec7370a3d.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"9a226cf1f58b48c5a9a5f39fd102cd99\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"iF4jsu1YOl"}],"visibility":"show","key":"uEBe2pXwLP"}],"visibility":"show","key":"VDBr5tAylj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Work with other bases","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMypYPCwEA"}],"identifier":"work-with-other-bases","label":"Work with other bases","html_id":"work-with-other-bases","implicit":true,"key":"p01pHgFtRm"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Radial basis function (RBF) is a good candidate to fit the data.\nIt will creat a smooth curve that will fit the data, but due to the non finite support of the RBF function, the matrix to invert will be ill conditionned.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gw75txb2Im"}],"key":"UWaTRZN5tN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The gaussian RBF is defined as follow:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ns1R3RKVZF"}],"key":"VO7TgYZCNF"},{"type":"math","value":"\\phi(x) = \\exp\\left(-\\left(\\frac{x-x_c}{lc}\\right)^2\\right)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>c</mi></msub></mrow><mrow><mi>l</mi><mi>c</mi></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mn>2</mn></msup><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\phi(x) = \\exp\\left(-\\left(\\frac{x-x_c}{lc}\\right)^2\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.654em;\"><span style=\"top:-3.9029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span>","enumerator":"1","key":"WYYGdPRklM"}],"key":"sqDHlfTb02"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def hat(x, xc, support=1):\n    ### RBF\n    y = np.exp(-((np.abs(x - xc) / support) ** 2))\n    return y","visibility":"show","key":"dIWEA1VTEl"},{"type":"outputs","id":"hfzlvCkUgWldkbzCcRJSR","children":[],"visibility":"show","key":"ZCZGilKHZN"}],"visibility":"show","key":"JLgv0rrU4p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfor i in range(0, len(xc_list)):\n    plt.plot(x_hat, hat(x_hat, xc_list[i], support))\nplt.grid()","key":"yzJiOWS5Me"},{"type":"outputs","id":"3cJRNCYSCXpQ-pgIb9KE6","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"23b9096177911d3e50b6ea0ab5cf3dc3","path":"/armageddon/build/23b9096177911d3e50b6ea0ab5cf3dc3.png"},"text/html":{"content_type":"text/html","hash":"e7cafc7f655fbd2e97f71aba2da29a40","path":"/armageddon/build/e7cafc7f655fbd2e97f71aba2da29a40.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"7291b8d0792040f5b36b2f97558cf63f\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"RbU4UMYucm"}],"key":"OIN75KHRS1"}],"key":"G6jTE37TN7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fit the data using this base of functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"voF33ZbQdJ"}],"identifier":"fit-the-data-using-this-base-of-functions","label":"Fit the data using this base of functions","html_id":"fit-the-data-using-this-base-of-functions-1","implicit":true,"key":"yGbDw7U26u"}],"key":"sY9qHAkXN5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Construcion of the X matrix\nX = np.zeros((Nf, len(x)))\nfor i in range(0, len(xc_list)):\n    X[i, :] = hat(x, xc_list[i], support)\nX = X.T\n\n# Construcion of the Y matrix\nY = y.T\n\n# Computation of the least square estimator\nbeta = np.dot(np.linalg.inv(np.dot(X.T, X)), np.dot(X.T, Y))\n\nprint(\"The fitted coeff:\")\nprint(beta)","key":"dT5zMuwaC5"},{"type":"outputs","id":"IILXzOmPeAC6kLfxatADb","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"The fitted coeff:\n[ 40.3808368  -24.28863137 -10.00502152 -13.56302099   1.67378011\n  -1.39221328   3.96758795  -7.79903348  11.16852575]\n"},"key":"ILNtbp7J3S"}],"key":"P2urYFRLRk"}],"key":"ZwNOVbZSJl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Draw the results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jYMQymrRtN"}],"identifier":"draw-the-results","label":"Draw the results","html_id":"draw-the-results-1","implicit":true,"key":"tq0zhXMDZU"}],"key":"gMT2vYvAHZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"N = 100\nxi = np.linspace(xmin, xmax, N)\n\nyi = np.zeros(xi.shape)\nfor i in range(0, len(xc_list)):\n    yi = yi + beta[i] * hat(xi, xc_list[i], support)","key":"fjdoy5vry3"},{"type":"outputs","id":"Hastr93EfCnIyH0FLEcj3","children":[],"key":"G4XHdmJuta"}],"key":"ut37PhzwDy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nplt.plot(x, y, \"o\", label=\"Data\")\nplt.plot(xi, yi, \"r\", label=\"Regression\")\nplt.legend()\nplt.grid()","key":"DRNxDV4HK5"},{"type":"outputs","id":"55Q2K630qACTpBw7ALArS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2b35e635ddcd2da89ba3115095a1d9ec","path":"/armageddon/build/2b35e635ddcd2da89ba3115095a1d9ec.png"},"text/html":{"content_type":"text/html","hash":"bdb846dbb75e8853ec1cc43915851889","path":"/armageddon/build/bdb846dbb75e8853ec1cc43915851889.html"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"6431ffab61a64c6684eb6d3e708dacb4\"}","content_type":"application/vnd.jupyter.widget-view+json"}}},"key":"y4PMt1WMhk"}],"key":"fjz3KIvv08"}],"key":"j7k0qm4lER"}],"key":"c5Y85qw8m3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Linear regression - Linear model","url":"/linear-regression-linear-model","group":"Data"},"next":{"title":"Derivation of numerical data","url":"/numerical-derivation","group":"Data"}}},"domain":"http://localhost:3002"}