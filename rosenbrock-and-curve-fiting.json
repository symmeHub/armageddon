{"version":3,"kind":"Notebook","sha256":"595051be4d4aba4c968a7ed35af67a2cdf5a177d8b6ca079f4ed2bca84ba4b56","slug":"rosenbrock-and-curve-fiting","location":"/optimization/exercises/rosenbrock_and_curve_fiting.ipynb","dependencies":[],"frontmatter":{"title":"Rosenbrock function and Curve fiting","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/symmeHub/positron","numbering":{"title":{"offset":2}},"source_url":"https://github.com/symmeHub/positron/blob/main/book/optimization/exercises/rosenbrock_and_curve_fiting.ipynb","edit_url":"https://github.com/symmeHub/positron/edit/main/book/optimization/exercises/rosenbrock_and_curve_fiting.ipynb","exports":[{"format":"ipynb","filename":"rosenbrock_and_curve_fiting.ipynb","url":"/armageddon/build/rosenbrock_and_curve-44bd8d7d5fe58e9a2d20ff8eb02130a2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The Rosenbrock function","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"s8E89zL2Zq"}],"identifier":"the-rosenbrock-function","label":"The Rosenbrock function","html_id":"the-rosenbrock-function","implicit":true,"key":"taws5yJXNa"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AHSaEqSVBZ"},{"type":"link","url":"https://fr.wikipedia.org/wiki/Fonction_de_Rosenbrock","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Rosenbrock function","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VHOwmgvdsk"}],"urlSource":"https://fr.wikipedia.org/wiki/Fonction_de_Rosenbrock","data":{"page":"Fonction_de_Rosenbrock","wiki":"https://fr.wikipedia.org/","lang":"fr"},"internal":false,"protocol":"wiki","key":"IvwYbxRf9J"},{"type":"text","value":" is a classical benchmark for optimization algorithms. It is defined by the following equation:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nge7gP9hGO"}],"key":"GLsKhBgHeB"},{"type":"math","value":"f(x, y) = (1-x)^2 + 100 (y-x^2)^2","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mn>100</mn><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(x, y) = (1-x)^2 + 100 (y-x^2)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">100</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"GAMpYzKTfm"}],"key":"Ri1MrqbAiB"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n\ndef Rosen(X):\n    \"\"\"\n    Rosenbrock function\n    \"\"\"\n    x, y = X\n    return (1 - x) ** 2 + 100.0 * (y - x**2) ** 2\n\n\nx = np.linspace(-2.0, 2.0, 100)\ny = np.linspace(-1.0, 3.0, 100)\nX, Y = np.meshgrid(x, y)\nZ = Rosen((X, Y))\n\nfig = plt.figure(0)\nplt.clf()\nplt.contourf(X, Y, Z, 20)\nplt.colorbar()\nplt.contour(X, Y, Z, 20, colors=\"black\")\nplt.grid()\nplt.xlabel(\"x\")\nplt.ylabel(\"y\")\nplt.show()","key":"VRIJqo0HFQ"},{"type":"outputs","id":"MNnsBWyXH7KCgm0E3JhuG","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"03cc1e689ec2a6c009b583a5e661d407","path":"/armageddon/build/03cc1e689ec2a6c009b583a5e661d407.png"}}},"key":"CXlAyNQUe8"}],"key":"nEVtyxgLBv"}],"key":"sIyr4Vh0K2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OnI7u3dSOp"}],"identifier":"questions","label":"Questions","html_id":"questions","implicit":true,"key":"wYwwEtnZMV"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Find the minimum of the function using brute force. Comment the accuracy and number of function evaluations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t3YYqeSDPF"}],"key":"eOnNilBatN"}],"key":"SnRIZ49K3f"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Same question with the simplex (Nelder-Mead) algorithm.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vDUiAvTxm0"}],"key":"nx3befyutT"}],"key":"B3Ei9pKja4"}],"key":"B1d6oWccYG"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Curve fitting","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lFwAiH6mxz"}],"identifier":"curve-fitting","label":"Curve fitting","html_id":"curve-fitting","implicit":true,"key":"vfuEh9kz7R"},{"type":"heading","depth":3,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Questions","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EJidRtMC2H"}],"identifier":"questions","label":"Questions","html_id":"questions-1","implicit":true,"key":"mS6LdluOjf"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Chose a mathematical function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CzCrOOQWBk"},{"type":"inlineMath","value":"y = f(x, a, b)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = f(x, a, b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span>","key":"cUongVWV6y"},{"type":"text","value":" and code it.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RIdcxrBONi"}],"key":"XMvYj7I9Yi"}],"key":"dAyBBPkAy7"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Chose target values of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vltcYBFo39"},{"type":"inlineMath","value":"a","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"uKvyUbbOkC"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xQJ0V8WW9J"},{"type":"inlineMath","value":"b","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"IbzzVRg1Of"},{"type":"text","value":" that you will try to find back using optimization.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ISZ1LNye0x"}],"key":"PFEGzyl5vA"}],"key":"FZRSQNbzQv"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Evaluate it on a grid of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GIumyide5C"},{"type":"inlineMath","value":"x","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Eo9BuXzct6"},{"type":"text","value":" values.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dNVr5ZfDZJ"}],"key":"stjQhSrVrH"}],"key":"qyB21soHlh"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add some noise to the result.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wGZGbXiAeY"}],"key":"LQUkHQNDN5"}],"key":"NPZkmAKLNz"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Find back ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MawQIgeBCJ"},{"type":"inlineMath","value":"a","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"eAMw0OQyZb"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"m4PgwkB1Ko"},{"type":"inlineMath","value":"b","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"t6FV3VqUEK"},{"type":"text","value":" using ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BpRUGov6U5"},{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"curve_fit","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CGAOSFTNZ2"}],"key":"o4XwvvhoSx"}],"key":"tzxT5q2pAn"}],"key":"UnM6V3DWZz"}],"key":"qtwp4GCxRv"}],"key":"SqIoyFOjjB"}],"key":"PGmiG6aZWj"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Exercices","url":"/exercises-4","group":"Optimization"},"next":{"title":"Optimizing a bridge structure","url":"/bridge-optimization","group":"Optimization"}}},"domain":"http://localhost:3002"}