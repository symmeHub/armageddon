{"version":3,"kind":"Notebook","sha256":"41280ba35e2b83ea1216f716ad4d848c0f2ec8d1201edbce0a4a35fc213682a3","slug":"word-generator","location":"/data_analysis/ressources/Word_Generator.ipynb","dependencies":[],"frontmatter":{"title":"Word Generator","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"science","language":"python"},"github":"https://github.com/symmeHub/positron","numbering":{"title":{"offset":2}},"source_url":"https://github.com/symmeHub/positron/blob/main/book/data_analysis/ressources/Word_Generator.ipynb","edit_url":"https://github.com/symmeHub/positron/edit/main/book/data_analysis/ressources/Word_Generator.ipynb","exports":[{"format":"ipynb","filename":"Word_Generator.ipynb","url":"/armageddon/build/Word_Generator-111813ff59a6ee4e3ee314aab32e9f68.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scope","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iBdd6pX8t0"}],"identifier":"scope","label":"Scope","html_id":"scope","implicit":true,"key":"itz3gGt3wn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook was inspired by the great video proposed by David Louapre available on his Youtube channel ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NhMf7HdxmP"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"“Science Etonnante”","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UsSgfgMs7D"}],"key":"fkKLu39lqN"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fYY7rhSJjh"}],"key":"kdNLcjgwPj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://sciencetonnante.wordpress.com/2015/11/06/la-machine-a-inventer-des-mots-version-ikea/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​sciencetonnante​.wordpress​.com​/2015​/11​/06​/la​-machine​-a​-inventer​-des​-mots​-version​-ikea/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sZJXWU7htd"}],"urlSource":"https://sciencetonnante.wordpress.com/2015/11/06/la-machine-a-inventer-des-mots-version-ikea/","key":"v9ZjCaCWQ7"}],"key":"E7ZbvYSOmY"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Here the word generator is embedded in a class.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nucOkgz6Xe"}],"key":"DdMEVTl9Ku"}],"key":"Buf0WZaD1u"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Setup\n%load_ext autoreload\n%matplotlib ipympl\n%autoreload 2\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport IPython, io, urllib\nimport codecs\nimport re\nfrom numpy.random import choice, seed\n\nseed(1)","visibility":"hide","key":"swRxDqn7c9"},{"type":"outputs","id":"iA05TdflllZDtkTh6xUZt","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"Matplotlib is building the font cache; this may take a moment.\n"},"key":"uVcU6FxQVE"}],"visibility":"show","key":"iTRrJFzomM"}],"visibility":"show","key":"uvpqy1dt3u"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The video","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FvP9qlpIhS"}],"identifier":"the-video","label":"The video","html_id":"the-video","implicit":true,"key":"hGaUhFl37T"}],"key":"Ro4HKJss7g"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"-"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"IPython.display.YouTubeVideo(\"YsR7r2378j0\")","visibility":"show","key":"TeJKUhPhjr"},{"type":"outputs","id":"zvTzX75RvK3mp_g4oBTfa","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<IPython.lib.display.YouTubeVideo at 0x7d01d3b6c920>","content_type":"text/plain"},"text/html":{"content":"\n        <iframe\n            width=\"400\"\n            height=\"300\"\n            src=\"https://www.youtube.com/embed/YsR7r2378j0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ","content_type":"text/html"},"image/jpeg":{"content_type":"image/jpeg","hash":"d897957e1083f7df3ffb3adf482e67ea","path":"/armageddon/build/d897957e1083f7df3ffb3adf482e67ea.jpeg"}}},"key":"uJPT6TARSw"}],"visibility":"show","key":"SxkBCpzCog"}],"visibility":"show","key":"eBW8ihafzr"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Class that manage the word generator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DW9bAPHjDa"}],"identifier":"the-class-that-manage-the-word-generator","label":"The Class that manage the word generator","html_id":"the-class-that-manage-the-word-generator","implicit":true,"key":"os9rezultx"}],"key":"nlZv1k0JFs"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"-"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"class word_generator:\n    def __init__(self, dic_file):\n        # Input file containing one word per line, and its encoding\n        # Assumes one word per line but if the the words are followed by\n        # a space, a tab, a slash, a comma, etc....the end of the line will be trimmed\n        self.dic_file = dic_file\n        self.encoding = \"ISO-8859-1\"\n\n        # Name of the output binary matrix, matrix image file and output txt file\n        count_file = r\"count_FR.bin\"\n        proba_matrix = r\"matrix_FR.png\"\n        self.outfile = r\"output.txt\"\n\n        self.read_dic()\n\n    def read_dic(self):\n        self.dico = []  # to store the words of the dictionnary\n\n        self.count = np.zeros((256, 256, 256), dtype=\"int32\")\n        with codecs.open(self.dic_file, \"r\", self.encoding) as lines:\n            for l in lines:\n                # Trimming of the line :\n                # Split on white space, tab, slash backslah or open parenthesis\n                # and keep the first string, add EOL character\n                l2 = re.split(\"[ /\\\\\\t,\\(]\", l)[0] + \"\\n\"\n                self.dico.append(l2[:-1])\n                i, j = 0, 0\n                for k in [ord(c) for c in list(l2)]:\n                    self.count[i, j, k] += 1\n                    i = j\n                    j = k\n\n    def plot(self):\n        count2D = self.count.sum(axis=0)\n        p2D = count2D.astype(\"float\") / np.tile(sum(count2D.T), (256, 1)).T\n        p2D[np.isnan(p2D)] = 0\n\n        # For better contrast, we plot p^alpha instead of p\n        alpha = 0.33\n        p2Da = p2D**alpha\n        self.p2Da = p2Da[97:123, 97:123]\n\n        # We display only letters a to z, ie ASCII from 97 to 123.\n        plt.figure(figsize=(8, 8))\n        gr = plt.imshow(self.p2Da, interpolation=\"nearest\", cmap=mpl.cm.OrRd)\n        plt.axis(\"off\")\n        cbar = plt.colorbar(gr, orientation=\"vertical\")\n\n        for i in range(97, 123):\n            plt.text(\n                -1,\n                i - 97,\n                chr(i),\n                horizontalalignment=\"center\",\n                verticalalignment=\"center\",\n            )\n            plt.text(\n                i - 97,\n                -1,\n                chr(i),\n                horizontalalignment=\"center\",\n                verticalalignment=\"center\",\n            )\n\n    def __call__(self):\n        # For the random generator : what is the minimum and maximum number of letters\n        # in the words that we want to generate, and how many words for each length\n        smin, smax = 4, 12\n        K = 5\n\n        # Compute the probabilities by normalizing the counts\n        s = self.count.sum(axis=2)\n        st = np.tile(s.T, (256, 1, 1)).T\n        p = self.count.astype(\"float\") / st\n        p[np.isnan(p)] = 0\n\n        f = codecs.open(self.outfile, \"w\", self.encoding)\n        # Generate words\n        for size in range(smin, smax + 1):\n            total = 0\n            while total < K:\n                i, j = 0, 0\n                res = \"\"\n                while not j == 10:\n                    k = choice(range(256), 1, p=p[i, j, :])[0]\n                    res = res + chr(k)\n                    i, j = j, k\n                if len(res) == 1 + size:\n                    x = res[:-1]\n                    if res[:-1] in self.dico:\n                        x = res[:-1] + \"*\"\n                    total += 1\n                    print(x)\n                    f.write(x + \"\\n\")\n        f.close()","visibility":"show","key":"XhG2Ew2nks"},{"type":"outputs","id":"ACN09wqZZdKqULewCQA20","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"<>:25: SyntaxWarning: invalid escape sequence '\\('\n<>:25: SyntaxWarning: invalid escape sequence '\\('\n/tmp/ipykernel_2892/599884686.py:25: SyntaxWarning: invalid escape sequence '\\('\n  l2 = re.split(\"[ /\\\\\\t,\\(]\", l)[0] + \"\\n\"\n"},"key":"SOHhTkcsUW"}],"visibility":"show","key":"F1SYcK0JGZ"}],"visibility":"show","key":"haIJFL1Tms"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"French","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UXfuKYYgui"}],"identifier":"french","label":"French","html_id":"french","implicit":true,"key":"XGlG94F2Hb"}],"key":"u2FHHrgHzz"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"fragment"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"gen_FR = word_generator(r\"_DATA/dic/FR_aisi.txt\")\ngen_FR.plot()\nplt.show()","visibility":"show","key":"kqCehVhlZJ"},{"type":"outputs","id":"5IgpGm1PRrtkds9fnczEh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_2892/599884686.py:25: SyntaxWarning: invalid escape sequence '\\('\n  l2 = re.split(\"[ /\\\\\\t,\\(]\", l)[0] + \"\\n\"\n"},"key":"M27TUAAQx8"},{"type":"output","children":[],"jupyter_data":{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mFileNotFoundError\u001b[39m                         Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m gen_FR = \u001b[43mword_generator\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43mr\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m_DATA/dic/FR_aisi.txt\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m      2\u001b[39m gen_FR.plot()\n\u001b[32m      3\u001b[39m plt.show()\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[3]\u001b[39m\u001b[32m, line 14\u001b[39m, in \u001b[36mword_generator.__init__\u001b[39m\u001b[34m(self, dic_file)\u001b[39m\n\u001b[32m     11\u001b[39m proba_matrix = \u001b[33mr\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mmatrix_FR.png\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m     12\u001b[39m \u001b[38;5;28mself\u001b[39m.outfile = \u001b[33mr\u001b[39m\u001b[33m\"\u001b[39m\u001b[33moutput.txt\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m---> \u001b[39m\u001b[32m14\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mread_dic\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[3]\u001b[39m\u001b[32m, line 20\u001b[39m, in \u001b[36mword_generator.read_dic\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m     17\u001b[39m \u001b[38;5;28mself\u001b[39m.dico = []  \u001b[38;5;66;03m# to store the words of the dictionnary\u001b[39;00m\n\u001b[32m     19\u001b[39m \u001b[38;5;28mself\u001b[39m.count = np.zeros((\u001b[32m256\u001b[39m, \u001b[32m256\u001b[39m, \u001b[32m256\u001b[39m), dtype=\u001b[33m\"\u001b[39m\u001b[33mint32\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[43mcodecs\u001b[49m\u001b[43m.\u001b[49m\u001b[43mopen\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mdic_file\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mr\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mas\u001b[39;00m lines:\n\u001b[32m     21\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m l \u001b[38;5;129;01min\u001b[39;00m lines:\n\u001b[32m     22\u001b[39m         \u001b[38;5;66;03m# Trimming of the line :\u001b[39;00m\n\u001b[32m     23\u001b[39m         \u001b[38;5;66;03m# Split on white space, tab, slash backslah or open parenthesis\u001b[39;00m\n\u001b[32m     24\u001b[39m         \u001b[38;5;66;03m# and keep the first string, add EOL character\u001b[39;00m\n\u001b[32m     25\u001b[39m         l2 = re.split(\u001b[33m\"\u001b[39m\u001b[33m[ /\u001b[39m\u001b[38;5;130;01m\\\\\u001b[39;00m\u001b[38;5;130;01m\\t\u001b[39;00m\u001b[33m,\u001b[39m\u001b[33m\\\u001b[39m\u001b[33m(]\u001b[39m\u001b[33m\"\u001b[39m, l)[\u001b[32m0\u001b[39m] + \u001b[33m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[33m\"\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m<frozen codecs>:918\u001b[39m, in \u001b[36mopen\u001b[39m\u001b[34m(filename, mode, encoding, errors, buffering)\u001b[39m\n\n\u001b[31mFileNotFoundError\u001b[39m: [Errno 2] No such file or directory: '_DATA/dic/FR_aisi.txt'","ename":"FileNotFoundError","evalue":"[Errno 2] No such file or directory: '_DATA/dic/FR_aisi.txt'"},"key":"T35je0PDk6"}],"visibility":"show","key":"YtJI7WUbRp"}],"visibility":"show","key":"HpUcjeQON0"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"gen_FR()","visibility":"show","key":"RVwm2kbnVc"},{"type":"outputs","id":"w-iDR0OaNI431IvI8dh2Z","children":[],"visibility":"show","key":"XSIXCkoOb7"}],"visibility":"show","key":"aNfBYN2Ous"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Swedish","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KecRbkAzdb"}],"identifier":"swedish","label":"Swedish","html_id":"swedish","implicit":true,"key":"fTPI2RKm1l"}],"key":"WCYRPdBkPs"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"fragment"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"gen_SE = word_generator(r\"_DATA/dic/SE_aisi.txt\")\ngen_SE.plot()","visibility":"show","key":"dEVpCjnklI"},{"type":"outputs","id":"xDb_eXL1roNXnsGW9LUJg","children":[],"visibility":"show","key":"gUaIdS4CPo"}],"visibility":"show","key":"DMcqxALJVQ"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"gen_SE()","visibility":"show","key":"zquTkRktfE"},{"type":"outputs","id":"OZLs5q7om_V0vRcc3fY_f","children":[],"visibility":"show","key":"U0Oqkz9BZ3"}],"visibility":"show","key":"c2s08vK6ME"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare french and swedisch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vyuQwDEesR"}],"identifier":"compare-french-and-swedisch","label":"Compare french and swedisch","html_id":"compare-french-and-swedisch","implicit":true,"key":"Iq96m9OkKH"}],"key":"DtNxifGOYx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nax = fig.add_subplot(1, 2, 1)\nax.imshow(gen_FR.p2Da, interpolation=\"nearest\", cmap=mpl.cm.OrRd)\nax.axis(\"off\")\nfor i in range(97, 123):\n    plt.text(\n        -1, i - 97, chr(i), horizontalalignment=\"center\", verticalalignment=\"center\"\n    )\n    plt.text(\n        i - 97, -1, chr(i), horizontalalignment=\"center\", verticalalignment=\"center\"\n    )\nplt.title(\"French\")\n\nax = fig.add_subplot(1, 2, 2)\nax.imshow(gen_SE.p2Da, interpolation=\"nearest\", cmap=mpl.cm.OrRd)\nax.axis(\"off\")\nfor i in range(97, 123):\n    plt.text(\n        -1, i - 97, chr(i), horizontalalignment=\"center\", verticalalignment=\"center\"\n    )\n    plt.text(\n        i - 97, -1, chr(i), horizontalalignment=\"center\", verticalalignment=\"center\"\n    )\nplt.title(\"Swedisch\")\nplt.show()","visibility":"show","key":"It9FkMHFSq"},{"type":"outputs","id":"0doNaE-6yMll81zO5Z4sw","children":[],"visibility":"show","key":"zXiJv3jjQR"}],"visibility":"show","key":"J03XBfb5wP"}],"key":"rbVeWg38bM"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Ressources","url":"/ressources","group":"Data"},"next":{"title":"Exercices","url":"/exercises-2","group":"Data"}}},"domain":"http://localhost:3002"}